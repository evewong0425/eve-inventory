<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2566">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="zh-TW"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;title&gt;德國橋牌計分器&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;script src="https://cdn.tailwindcss.com"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;link href="https://fonts.googleapis.com/css2?family=VT323&amp;display=swap" rel="stylesheet"&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>:root {</p>
<p class="p1"><span class="Apple-converted-space">      </span>--primary: #7C1E13;</p>
<p class="p1"><span class="Apple-converted-space">      </span>--secondary: #1C3144;</p>
<p class="p1"><span class="Apple-converted-space">      </span>--accent: #D4AF37;</p>
<p class="p1"><span class="Apple-converted-space">      </span>--light-bg: #F4EBD9;</p>
<p class="p1"><span class="Apple-converted-space">      </span>--dark-bg: #2A2730;</p>
<p class="p1"><span class="Apple-converted-space">      </span>--pixel-size: 2px;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>/* 自定義確認對話框樣式 */</p>
<p class="p1"><span class="Apple-converted-space">    </span>.modal-overlay {</p>
<p class="p1"><span class="Apple-converted-space">      </span>position: fixed;</p>
<p class="p1"><span class="Apple-converted-space">      </span>top: 0;</p>
<p class="p1"><span class="Apple-converted-space">      </span>left: 0;</p>
<p class="p1"><span class="Apple-converted-space">      </span>right: 0;</p>
<p class="p1"><span class="Apple-converted-space">      </span>bottom: 0;</p>
<p class="p1"><span class="Apple-converted-space">      </span>background-color: rgba(0, 0, 0, 0.5);</p>
<p class="p1"><span class="Apple-converted-space">      </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">      </span>justify-content: center;</p>
<p class="p1"><span class="Apple-converted-space">      </span>align-items: center;</p>
<p class="p1"><span class="Apple-converted-space">      </span>z-index: 1000;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>.modal-content {</p>
<p class="p1"><span class="Apple-converted-space">      </span>background-color: var(--light-bg);</p>
<p class="p1"><span class="Apple-converted-space">      </span>padding: 20px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>border: var(--pixel-size) solid var(--secondary);</p>
<p class="p1"><span class="Apple-converted-space">      </span>box-shadow: var(--pixel-size) var(--pixel-size) 0 0 var(--secondary);</p>
<p class="p1"><span class="Apple-converted-space">      </span>max-width: 90%;</p>
<p class="p1"><span class="Apple-converted-space">      </span>width: 400px;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>.dark .modal-content {</p>
<p class="p1"><span class="Apple-converted-space">      </span>background-color: var(--dark-bg);</p>
<p class="p1"><span class="Apple-converted-space">      </span>border-color: var(--light-bg);</p>
<p class="p1"><span class="Apple-converted-space">      </span>box-shadow: var(--pixel-size) var(--pixel-size) 0 0 var(--light-bg);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>.first-bidder {</p>
<p class="p1"><span class="Apple-converted-space">      </span>position: relative;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>.first-bidder::before {</p>
<p class="p1"><span class="Apple-converted-space">      </span>content: "⭐";</p>
<p class="p1"><span class="Apple-converted-space">      </span>position: absolute;</p>
<p class="p1"><span class="Apple-converted-space">      </span>left: -20px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>font-size: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>body {</p>
<p class="p1"><span class="Apple-converted-space">      </span>font-family: 'VT323', monospace;</p>
<p class="p1"><span class="Apple-converted-space">      </span>background-color: var(--light-bg);</p>
<p class="p1"><span class="Apple-converted-space">      </span>color: var(--secondary);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>.dark body {</p>
<p class="p1"><span class="Apple-converted-space">      </span>background-color: var(--dark-bg);</p>
<p class="p1"><span class="Apple-converted-space">      </span>color: var(--light-bg);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>.pixel-border {</p>
<p class="p1"><span class="Apple-converted-space">      </span>position: relative;</p>
<p class="p1"><span class="Apple-converted-space">      </span>border: var(--pixel-size) solid var(--secondary);</p>
<p class="p1"><span class="Apple-converted-space">      </span>box-shadow: var(--pixel-size) var(--pixel-size) 0 0 var(--secondary);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>.dark .pixel-border {</p>
<p class="p1"><span class="Apple-converted-space">      </span>border-color: var(--light-bg);</p>
<p class="p1"><span class="Apple-converted-space">      </span>box-shadow: var(--pixel-size) var(--pixel-size) 0 0 var(--light-bg);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>.pixel-button {</p>
<p class="p1"><span class="Apple-converted-space">      </span>background-color: var(--accent);</p>
<p class="p1"><span class="Apple-converted-space">      </span>color: var(--secondary);</p>
<p class="p1"><span class="Apple-converted-space">      </span>border: var(--pixel-size) solid var(--secondary);</p>
<p class="p1"><span class="Apple-converted-space">      </span>box-shadow: var(--pixel-size) var(--pixel-size) 0 0 var(--secondary);</p>
<p class="p1"><span class="Apple-converted-space">      </span>transition: all 0.1s;</p>
<p class="p1"><span class="Apple-converted-space">      </span>text-transform: uppercase;</p>
<p class="p1"><span class="Apple-converted-space">      </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>.pixel-button:hover {</p>
<p class="p1"><span class="Apple-converted-space">      </span>transform: translate(1px, 1px);</p>
<p class="p1"><span class="Apple-converted-space">      </span>box-shadow: calc(var(--pixel-size) - 1px) calc(var(--pixel-size) - 1px) 0 0 var(--secondary);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>.pixel-button:active {</p>
<p class="p1"><span class="Apple-converted-space">      </span>transform: translate(var(--pixel-size), var(--pixel-size));</p>
<p class="p1"><span class="Apple-converted-space">      </span>box-shadow: none;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>.dark .pixel-button {</p>
<p class="p1"><span class="Apple-converted-space">      </span>border-color: var(--light-bg);</p>
<p class="p1"><span class="Apple-converted-space">      </span>box-shadow: var(--pixel-size) var(--pixel-size) 0 0 var(--light-bg);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>.dark .pixel-button:hover {</p>
<p class="p1"><span class="Apple-converted-space">      </span>box-shadow: calc(var(--pixel-size) - 1px) calc(var(--pixel-size) - 1px) 0 0 var(--light-bg);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>.suit {</p>
<p class="p1"><span class="Apple-converted-space">      </span>font-size: 1.5rem;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>.spades { color: #000000; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.hearts { color: #FF0000; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.diamonds { color: #FF0000; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.clubs { color: #000000; }</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>.dark .spades, .dark .clubs { color: #FFFFFF; }</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>.just-made {</p>
<p class="p1"><span class="Apple-converted-space">      </span>color: #006400;</p>
<p class="p1"><span class="Apple-converted-space">      </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>.dark .just-made {</p>
<p class="p1"><span class="Apple-converted-space">      </span>color: #00FF00;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>.missed {</p>
<p class="p1"><span class="Apple-converted-space">      </span>color: #8B0000;</p>
<p class="p1"><span class="Apple-converted-space">      </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>.dark .missed {</p>
<p class="p1"><span class="Apple-converted-space">      </span>color: #FF6347;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>/* Input styling */</p>
<p class="p1"><span class="Apple-converted-space">    </span>input[type="text"], input[type="number"], select {</p>
<p class="p1"><span class="Apple-converted-space">      </span>background-color: var(--light-bg);</p>
<p class="p1"><span class="Apple-converted-space">      </span>border: var(--pixel-size) solid var(--secondary);</p>
<p class="p1"><span class="Apple-converted-space">      </span>font-family: 'VT323', monospace;</p>
<p class="p1"><span class="Apple-converted-space">      </span>font-size: 1.2rem;</p>
<p class="p1"><span class="Apple-converted-space">      </span>padding: 6px 10px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>outline: none;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>.dark input[type="text"], .dark input[type="number"], .dark select {</p>
<p class="p1"><span class="Apple-converted-space">      </span>background-color: var(--dark-bg);</p>
<p class="p1"><span class="Apple-converted-space">      </span>color: var(--light-bg);</p>
<p class="p1"><span class="Apple-converted-space">      </span>border-color: var(--light-bg);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>input[type="number"] {</p>
<p class="p1"><span class="Apple-converted-space">      </span>width: 60px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>table {</p>
<p class="p1"><span class="Apple-converted-space">      </span>border-collapse: separate;</p>
<p class="p1"><span class="Apple-converted-space">      </span>border-spacing: 0;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>th, td {</p>
<p class="p1"><span class="Apple-converted-space">      </span>border: var(--pixel-size) solid var(--secondary);</p>
<p class="p1"><span class="Apple-converted-space">      </span>padding: 8px 12px;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>.dark th, .dark td {</p>
<p class="p1"><span class="Apple-converted-space">      </span>border-color: var(--light-bg);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>th {</p>
<p class="p1"><span class="Apple-converted-space">      </span>background-color: var(--primary);</p>
<p class="p1"><span class="Apple-converted-space">      </span>color: var(--light-bg);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>tr:nth-child(even) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>background-color: rgba(0, 0, 0, 0.05);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>.dark tr:nth-child(even) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>background-color: rgba(255, 255, 255, 0.05);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>.screen {</p>
<p class="p1"><span class="Apple-converted-space">      </span>display: none;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>.warning {</p>
<p class="p1"><span class="Apple-converted-space">      </span>color: #FF0000;</p>
<p class="p1"><span class="Apple-converted-space">      </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;!-- 確認對話框 --&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;div id="confirmModal" class="modal-overlay hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="modal-content"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;h3 class="text-xl font-bold mb-4"&gt;確認操作&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;p id="confirmMessage" class="mb-4"&gt;確定要重置遊戲嗎？所有數據將被清除！&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="flex justify-end gap-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button id="cancelBtn" class="pixel-button px-4 py-2"&gt;取消&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button id="confirmBtn" class="pixel-button px-4 py-2"&gt;確定&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;div class="container mx-auto px-4 py-8 max-w-6xl"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;header class="text-center mb-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;h1 class="text-4xl font-bold mb-2"&gt;德國橋牌計分器&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="flex justify-center gap-2 mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;span class="suit spades"&gt;♠&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;span class="suit hearts"&gt;♥&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;span class="suit diamonds"&gt;♦&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;span class="suit clubs"&gt;♣&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;button id="toggleDarkMode" class="pixel-button px-4 py-2 text-sm"&gt;切換深色模式&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/header&gt;</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Setup Screen --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="setupScreen" class="screen pixel-border p-6 mb-8 mx-auto max-w-2xl"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;h2 class="text-2xl font-bold mb-4"&gt;遊戲設置&lt;/h2&gt;</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="mb-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;h3 class="text-xl mb-2"&gt;玩家設置&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="playersContainer" class="mb-4 space-y-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;!-- Players will be added here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="flex gap-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;button id="addPlayer" class="pixel-button px-4 py-2"&gt;添加玩家&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;button id="removePlayer" class="pixel-button px-4 py-2"&gt;移除玩家&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="mb-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;h3 class="text-xl mb-2"&gt;回合設置&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="flex flex-wrap gap-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;label for="startRound" class="block mb-1"&gt;起始回合:&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;input type="number" id="startRound" min="1" max="13" value="1" class="text-base"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;label for="endRound" class="block mb-1"&gt;結束回合:&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;input type="number" id="endRound" min="1" max="13" value="13" class="text-base"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;p id="roundError" class="warning mt-2 hidden"&gt;回合設置無效&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;button id="startGame" class="pixel-button px-6 py-3 text-lg w-full"&gt;開始遊戲&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Game Screen --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="gameScreen" class="screen mb-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="flex justify-between items-center mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;h2 class="text-2xl font-bold"&gt;回合 &lt;span id="currentRound"&gt;1&lt;/span&gt; / &lt;span id="totalRounds"&gt;13&lt;/span&gt;&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;p&gt;每人 &lt;span id="cardsPerPlayer"&gt;1&lt;/span&gt; 張牌&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="flex gap-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;button id="prevRound" class="pixel-button px-4 py-2"&gt;上一回合&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;button id="nextRound" class="pixel-button px-4 py-2"&gt;下一回合&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="grid md:grid-cols-2 gap-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Trump Selection --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="pixel-border p-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;h3 class="text-xl font-bold mb-2"&gt;王牌選擇&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div class="flex gap-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button data-suit="spades" class="trump-btn pixel-button px-4 py-2"&gt;&lt;span class="suit spades"&gt;♠&lt;/span&gt; 葵扇&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button data-suit="hearts" class="trump-btn pixel-button px-4 py-2"&gt;&lt;span class="suit hearts"&gt;♥&lt;/span&gt; 紅心&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button data-suit="clubs" class="trump-btn pixel-button px-4 py-2"&gt;&lt;span class="suit clubs"&gt;♣&lt;/span&gt; 梅花&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button data-suit="diamonds" class="trump-btn pixel-button px-4 py-2"&gt;&lt;span class="suit diamonds"&gt;♦&lt;/span&gt; 方塊&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div class="mt-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;p&gt;本回合王牌: &lt;span id="currentTrump"&gt;未選擇&lt;/span&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Bid Summary --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="pixel-border p-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;h3 class="text-xl font-bold mb-2"&gt;叫牌總結&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;p&gt;玩家叫牌總和: &lt;span id="totalBids"&gt;0&lt;/span&gt; / &lt;span id="totalCards"&gt;0&lt;/span&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;p id="lastPlayerWarning" class="warning hidden"&gt;最後一位玩家不能叫這個數目!&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;p id="lastPlayerRestriction" class="mt-1 hidden"&gt;最後一位玩家不能叫 &lt;span id="restrictedBid"&gt;0&lt;/span&gt; 墩&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;p id="bidSummaryStatus" class="mt-1 hidden"&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;p id="tricksSumWarning" class="warning mt-1 hidden"&gt;贏墩總和必須等於 &lt;span id="requiredTricksSum"&gt;0&lt;/span&gt; 墩!&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;!-- Player Scores --&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="mt-6 pixel-border p-4 overflow-x-auto"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;table class="w-full"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;thead&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;th&gt;玩家&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;th&gt;叫牌&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;th&gt;贏墩&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;th&gt;本輪得分&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;th&gt;總分&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/thead&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;tbody id="scoreTableBody"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Player scores will be populated here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/tbody&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/table&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="mt-6 flex justify-between"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button id="showHistory" class="pixel-button px-4 py-2"&gt;查看歷史記錄&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;button id="newGameBtn" class="pixel-button px-4 py-2 hidden mr-2"&gt;開新遊戲&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;button id="resetGame" class="pixel-button px-4 py-2"&gt;重置遊戲&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- History Screen --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="historyScreen" class="screen"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;h2 class="text-2xl font-bold mb-4"&gt;歷史記錄&lt;/h2&gt;</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="pixel-border p-4 overflow-x-auto"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;table class="w-full"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;thead id="historyTableHead"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;th&gt;回合&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;th&gt;王牌&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;!-- Player columns will be added dynamically --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/thead&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;tbody id="historyTableBody"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- History will be populated here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/tbody&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/table&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="mt-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button id="backToGame" class="pixel-button px-4 py-2"&gt;返回遊戲&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>// Game state</p>
<p class="p1"><span class="Apple-converted-space">    </span>const gameState = {</p>
<p class="p1"><span class="Apple-converted-space">      </span>players: ['玩家1', '玩家2', '玩家3', '玩家4'],</p>
<p class="p1"><span class="Apple-converted-space">      </span>settings: {</p>
<p class="p1"><span class="Apple-converted-space">        </span>startRound: 1,</p>
<p class="p1"><span class="Apple-converted-space">        </span>endRound: 13</p>
<p class="p1"><span class="Apple-converted-space">      </span>},</p>
<p class="p1"><span class="Apple-converted-space">      </span>currentRoundIndex: 0,</p>
<p class="p1"><span class="Apple-converted-space">      </span>rounds: []</p>
<p class="p1"><span class="Apple-converted-space">    </span>};</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>// DOM Elements</p>
<p class="p1"><span class="Apple-converted-space">    </span>const setupScreen = document.getElementById('setupScreen');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const gameScreen = document.getElementById('gameScreen');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const historyScreen = document.getElementById('historyScreen');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const playersContainer = document.getElementById('playersContainer');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const addPlayerBtn = document.getElementById('addPlayer');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const removePlayerBtn = document.getElementById('removePlayer');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const startRoundInput = document.getElementById('startRound');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const endRoundInput = document.getElementById('endRound');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const roundError = document.getElementById('roundError');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const startGameBtn = document.getElementById('startGame');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const currentRoundSpan = document.getElementById('currentRound');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const totalRoundsSpan = document.getElementById('totalRounds');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const cardsPerPlayerSpan = document.getElementById('cardsPerPlayer');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const prevRoundBtn = document.getElementById('prevRound');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const nextRoundBtn = document.getElementById('nextRound');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const trumpBtns = document.querySelectorAll('.trump-btn');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const currentTrumpSpan = document.getElementById('currentTrump');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const totalBidsSpan = document.getElementById('totalBids');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const totalCardsSpan = document.getElementById('totalCards');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const lastPlayerWarningSpan = document.getElementById('lastPlayerWarning');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const scoreTableBody = document.getElementById('scoreTableBody');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const showHistoryBtn = document.getElementById('showHistory');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const resetGameBtn = document.getElementById('resetGame');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const historyTableHead = document.getElementById('historyTableHead');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const historyTableBody = document.getElementById('historyTableBody');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const backToGameBtn = document.getElementById('backToGame');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const toggleDarkModeBtn = document.getElementById('toggleDarkMode');</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Initialize</p>
<p class="p1"><span class="Apple-converted-space">    </span>function init() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>checkDarkMode();</p>
<p class="p1"><span class="Apple-converted-space">      </span>toggleDarkModeBtn.addEventListener('click', toggleDarkMode);</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Setup default players</p>
<p class="p1"><span class="Apple-converted-space">      </span>renderPlayers();</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Event listeners for setup screen</p>
<p class="p1"><span class="Apple-converted-space">      </span>addPlayerBtn.addEventListener('click', addPlayer);</p>
<p class="p1"><span class="Apple-converted-space">      </span>removePlayerBtn.addEventListener('click', removePlayer);</p>
<p class="p1"><span class="Apple-converted-space">      </span>startRoundInput.addEventListener('change', validateRounds);</p>
<p class="p1"><span class="Apple-converted-space">      </span>endRoundInput.addEventListener('change', validateRounds);</p>
<p class="p1"><span class="Apple-converted-space">      </span>startGameBtn.addEventListener('click', startGame);</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Event listeners for game screen</p>
<p class="p1"><span class="Apple-converted-space">      </span>prevRoundBtn.addEventListener('click', goToPrevRound);</p>
<p class="p1"><span class="Apple-converted-space">      </span>nextRoundBtn.addEventListener('click', goToNextRound);</p>
<p class="p1"><span class="Apple-converted-space">      </span>trumpBtns.forEach(btn =&gt; btn.addEventListener('click', selectTrump));</p>
<p class="p1"><span class="Apple-converted-space">      </span>showHistoryBtn.addEventListener('click', showHistory);</p>
<p class="p1"><span class="Apple-converted-space">      </span>resetGameBtn.addEventListener('click', confirmResetGame);</p>
<p class="p1"><span class="Apple-converted-space">      </span>document.getElementById('newGameBtn').addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>showConfirmModal('開始新遊戲？當前資料將被保存在歷史記錄中。', resetGame);</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Event listener for history screen</p>
<p class="p1"><span class="Apple-converted-space">      </span>backToGameBtn.addEventListener('click', backToGame);</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Show setup screen</p>
<p class="p1"><span class="Apple-converted-space">      </span>showScreen(setupScreen);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Dark mode toggle</p>
<p class="p1"><span class="Apple-converted-space">    </span>function checkDarkMode() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (window.matchMedia &amp;&amp; window.matchMedia('(prefers-color-scheme: dark)').matches) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>document.documentElement.classList.add('dark');</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (event.matches) {</p>
<p class="p1"><span class="Apple-converted-space">          </span>document.documentElement.classList.add('dark');</p>
<p class="p1"><span class="Apple-converted-space">        </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">          </span>document.documentElement.classList.remove('dark');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>function toggleDarkMode() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>document.documentElement.classList.toggle('dark');</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Player management</p>
<p class="p1"><span class="Apple-converted-space">    </span>function renderPlayers() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>playersContainer.innerHTML = '';</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>gameState.players.forEach((player, index) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>const playerDiv = document.createElement('div');</p>
<p class="p1"><span class="Apple-converted-space">        </span>playerDiv.className = 'flex items-center gap-2';</p>
<p class="p1"><span class="Apple-converted-space">        </span>playerDiv.innerHTML = `</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;span class="w-20"&gt;玩家 ${index + 1}:&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;input type="text" class="player-name text-base flex-1" value="${player}" placeholder="玩家名稱"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>`;</p>
<p class="p1"><span class="Apple-converted-space">        </span>playersContainer.appendChild(playerDiv);</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>updateRemoveButtonState();</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>function addPlayer() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (gameState.players.length &lt; 8) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>gameState.players.push(`玩家${gameState.players.length + 1}`);</p>
<p class="p1"><span class="Apple-converted-space">        </span>renderPlayers();</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>function removePlayer() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (gameState.players.length &gt; 2) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>gameState.players.pop();</p>
<p class="p1"><span class="Apple-converted-space">        </span>renderPlayers();</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>function updateRemoveButtonState() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>removePlayerBtn.disabled = gameState.players.length &lt;= 2;</p>
<p class="p1"><span class="Apple-converted-space">      </span>removePlayerBtn.style.opacity = gameState.players.length &lt;= 2 ? 0.5 : 1;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Round validation</p>
<p class="p1"><span class="Apple-converted-space">    </span>function validateRounds() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const startRound = parseInt(startRoundInput.value);</p>
<p class="p1"><span class="Apple-converted-space">      </span>const endRound = parseInt(endRoundInput.value);</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>let isValid = true;</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (startRound &lt; 1 || startRound &gt; 13 || endRound &lt; 1 || endRound &gt; 13 || startRound &gt; endRound) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>isValid = false;</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>roundError.classList.toggle('hidden', isValid);</p>
<p class="p1"><span class="Apple-converted-space">      </span>startGameBtn.disabled = !isValid;</p>
<p class="p1"><span class="Apple-converted-space">      </span>startGameBtn.style.opacity = isValid ? 1 : 0.5;</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>return isValid;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Game initialization</p>
<p class="p1"><span class="Apple-converted-space">    </span>function startGame() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (!validateRounds()) return;</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Update player names</p>
<p class="p1"><span class="Apple-converted-space">      </span>const playerInputs = document.querySelectorAll('.player-name');</p>
<p class="p1"><span class="Apple-converted-space">      </span>playerInputs.forEach((input, index) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>gameState.players[index] = input.value || `玩家${index + 1}`;</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Set game settings</p>
<p class="p1"><span class="Apple-converted-space">      </span>gameState.settings.startRound = parseInt(startRoundInput.value);</p>
<p class="p1"><span class="Apple-converted-space">      </span>gameState.settings.endRound = parseInt(endRoundInput.value);</p>
<p class="p1"><span class="Apple-converted-space">      </span>gameState.currentRoundIndex = 0;</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Initialize rounds</p>
<p class="p1"><span class="Apple-converted-space">      </span>initializeRounds();</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Update UI</p>
<p class="p1"><span class="Apple-converted-space">      </span>updateGameUI();</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Show game screen</p>
<p class="p1"><span class="Apple-converted-space">      </span>showScreen(gameScreen);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>function initializeRounds() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>gameState.rounds = [];</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>for (let r = gameState.settings.startRound; r &lt;= gameState.settings.endRound; r++) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>const cardsPerPlayer = r;</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>const roundData = {</p>
<p class="p1"><span class="Apple-converted-space">          </span>roundNumber: r,</p>
<p class="p1"><span class="Apple-converted-space">          </span>cardsPerPlayer: cardsPerPlayer,</p>
<p class="p1"><span class="Apple-converted-space">          </span>trump: '',</p>
<p class="p1"><span class="Apple-converted-space">          </span>bids: Array(gameState.players.length).fill(0),</p>
<p class="p1"><span class="Apple-converted-space">          </span>tricks: Array(gameState.players.length).fill(0),</p>
<p class="p1"><span class="Apple-converted-space">          </span>scores: Array(gameState.players.length).fill(0),</p>
<p class="p1"><span class="Apple-converted-space">          </span>totals: gameState.rounds.length &gt; 0<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>? [...gameState.rounds[gameState.rounds.length - 1].totals]<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>: Array(gameState.players.length).fill(0)</p>
<p class="p1"><span class="Apple-converted-space">        </span>};</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>gameState.rounds.push(roundData);</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Screen navigation</p>
<p class="p1"><span class="Apple-converted-space">    </span>function showScreen(screen) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>setupScreen.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">      </span>gameScreen.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">      </span>historyScreen.style.display = 'none';</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>screen.style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>function goToPrevRound() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (gameState.currentRoundIndex &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>gameState.currentRoundIndex--;</p>
<p class="p1"><span class="Apple-converted-space">        </span>updateGameUI();</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>function goToNextRound() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (gameState.currentRoundIndex &lt; gameState.rounds.length - 1) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>gameState.currentRoundIndex++;</p>
<p class="p1"><span class="Apple-converted-space">        </span>updateGameUI();</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>function showHistory() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>renderHistoryTable();</p>
<p class="p1"><span class="Apple-converted-space">      </span>showScreen(historyScreen);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>function backToGame() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>showScreen(gameScreen);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Game UI updates</p>
<p class="p1"><span class="Apple-converted-space">    </span>function updateGameUI() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const currentRound = gameState.rounds[gameState.currentRoundIndex];</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Update round info</p>
<p class="p1"><span class="Apple-converted-space">      </span>currentRoundSpan.textContent = currentRound.roundNumber;</p>
<p class="p1"><span class="Apple-converted-space">      </span>totalRoundsSpan.textContent = gameState.settings.endRound;</p>
<p class="p1"><span class="Apple-converted-space">      </span>cardsPerPlayerSpan.textContent = currentRound.cardsPerPlayer;</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Update trump display</p>
<p class="p1"><span class="Apple-converted-space">      </span>updateTrumpDisplay();</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Update bid summary</p>
<p class="p1"><span class="Apple-converted-space">      </span>updateBidSummary();</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Update score table</p>
<p class="p1"><span class="Apple-converted-space">      </span>renderScoreTable();</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Update navigation buttons</p>
<p class="p1"><span class="Apple-converted-space">      </span>prevRoundBtn.disabled = gameState.currentRoundIndex === 0;</p>
<p class="p1"><span class="Apple-converted-space">      </span>prevRoundBtn.style.opacity = gameState.currentRoundIndex === 0 ? 0.5 : 1;</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>nextRoundBtn.disabled = gameState.currentRoundIndex === gameState.rounds.length - 1;</p>
<p class="p1"><span class="Apple-converted-space">      </span>nextRoundBtn.style.opacity = gameState.currentRoundIndex === gameState.rounds.length - 1 ? 0.5 : 1;</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// 顯示/隱藏開新遊戲按鈕</p>
<p class="p1"><span class="Apple-converted-space">      </span>const newGameBtn = document.getElementById('newGameBtn');</p>
<p class="p1"><span class="Apple-converted-space">      </span>const isLastRound = currentRound.roundNumber === 13;</p>
<p class="p1"><span class="Apple-converted-space">      </span>newGameBtn.classList.toggle('hidden', !isLastRound);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>function updateTrumpDisplay() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const currentRound = gameState.rounds[gameState.currentRoundIndex];</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Reset active state for all trump buttons</p>
<p class="p1"><span class="Apple-converted-space">      </span>trumpBtns.forEach(btn =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>btn.classList.remove('bg-gray-300');</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Mark current trump as active</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (currentRound.trump) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>const activeBtn = document.querySelector(`.trump-btn[data-suit="${currentRound.trump}"]`);</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (activeBtn) {</p>
<p class="p1"><span class="Apple-converted-space">          </span>activeBtn.classList.add('bg-gray-300');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Update trump display</p>
<p class="p1"><span class="Apple-converted-space">        </span>let trumpSymbol = '';</p>
<p class="p1"><span class="Apple-converted-space">        </span>let trumpName = '';</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>switch (currentRound.trump) {</p>
<p class="p1"><span class="Apple-converted-space">          </span>case 'spades':</p>
<p class="p1"><span class="Apple-converted-space">            </span>trumpSymbol = '♠';</p>
<p class="p1"><span class="Apple-converted-space">            </span>trumpName = '葵扇';</p>
<p class="p1"><span class="Apple-converted-space">            </span>break;</p>
<p class="p1"><span class="Apple-converted-space">          </span>case 'hearts':</p>
<p class="p1"><span class="Apple-converted-space">            </span>trumpSymbol = '♥';</p>
<p class="p1"><span class="Apple-converted-space">            </span>trumpName = '紅心';</p>
<p class="p1"><span class="Apple-converted-space">            </span>break;</p>
<p class="p1"><span class="Apple-converted-space">          </span>case 'diamonds':</p>
<p class="p1"><span class="Apple-converted-space">            </span>trumpSymbol = '♦';</p>
<p class="p1"><span class="Apple-converted-space">            </span>trumpName = '方塊';</p>
<p class="p1"><span class="Apple-converted-space">            </span>break;</p>
<p class="p1"><span class="Apple-converted-space">          </span>case 'clubs':</p>
<p class="p1"><span class="Apple-converted-space">            </span>trumpSymbol = '♣';</p>
<p class="p1"><span class="Apple-converted-space">            </span>trumpName = '梅花';</p>
<p class="p1"><span class="Apple-converted-space">            </span>break;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>currentTrumpSpan.innerHTML = `&lt;span class="suit ${currentRound.trump}"&gt;${trumpSymbol}&lt;/span&gt; ${trumpName}`;</p>
<p class="p1"><span class="Apple-converted-space">      </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">        </span>currentTrumpSpan.textContent = '未選擇';</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>function selectTrump(e) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const suit = e.currentTarget.dataset.suit;</p>
<p class="p1"><span class="Apple-converted-space">      </span>gameState.rounds[gameState.currentRoundIndex].trump = suit;</p>
<p class="p1"><span class="Apple-converted-space">      </span>updateTrumpDisplay();</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>function updateBidSummary() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const currentRound = gameState.rounds[gameState.currentRoundIndex];</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>const totalBids = currentRound.bids.reduce((sum, bid) =&gt; sum + bid, 0);</p>
<p class="p1"><span class="Apple-converted-space">      </span>// 每位玩家手中的牌數</p>
<p class="p1"><span class="Apple-converted-space">      </span>const cardsPerPlayer = currentRound.cardsPerPlayer;</p>
<p class="p1"><span class="Apple-converted-space">      </span>// 所有玩家的牌數總和，等於每位玩家贏墩總和</p>
<p class="p1"><span class="Apple-converted-space">      </span>const totalTricks = cardsPerPlayer * gameState.players.length;</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>totalBidsSpan.textContent = totalBids;</p>
<p class="p1"><span class="Apple-converted-space">      </span>totalCardsSpan.textContent = totalTricks;</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// 更新贏墩總和限制提示</p>
<p class="p1"><span class="Apple-converted-space">      </span>const tricksSumWarning = document.getElementById('tricksSumWarning');</p>
<p class="p1"><span class="Apple-converted-space">      </span>const requiredTricksSum = document.getElementById('requiredTricksSum');</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>if (requiredTricksSum) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>requiredTricksSum.textContent = totalTricks;</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// 計算贏墩總和</p>
<p class="p1"><span class="Apple-converted-space">      </span>const totalTricksWon = currentRound.tricks.reduce((sum, trick) =&gt; sum + trick, 0);</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// 如果有贏墩記錄，檢查總和是否等於應該的總墩數</p>
<p class="p1"><span class="Apple-converted-space">      </span>const hasAnyTricks = currentRound.tricks.some(trick =&gt; trick &gt; 0);</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (hasAnyTricks) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>tricksSumWarning.classList.toggle('hidden', totalTricksWon === totalTricks);</p>
<p class="p1"><span class="Apple-converted-space">      </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">        </span>tricksSumWarning.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// 顯示最後一位玩家不能叫什麼數目</p>
<p class="p1"><span class="Apple-converted-space">      </span>const lastPlayerRestriction = document.getElementById('lastPlayerRestriction');</p>
<p class="p1"><span class="Apple-converted-space">      </span>const restrictedBid = document.getElementById('restrictedBid');</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// 計算前三名玩家的叫牌總和</p>
<p class="p1"><span class="Apple-converted-space">      </span>const firstThreePlayersBids = currentRound.bids.slice(0, gameState.players.length - 1).reduce((sum, bid) =&gt; sum + bid, 0);</p>
<p class="p1"><span class="Apple-converted-space">      </span>const nonLastPlayersWithBids = currentRound.bids.slice(0, gameState.players.length - 1).filter(bid =&gt; bid &gt; 0).length;</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// 如果前三名玩家都輸入了叫牌，就顯示最後一名玩家的限制</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (nonLastPlayersWithBids === gameState.players.length - 1) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>const restricted = cardsPerPlayer - firstThreePlayersBids;</p>
<p class="p1"><span class="Apple-converted-space">        </span>restrictedBid.textContent = restricted;</p>
<p class="p1"><span class="Apple-converted-space">        </span>lastPlayerRestriction.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">      </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">        </span>lastPlayerRestriction.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// 顯示"搶墩"或"餵墩"信息</p>
<p class="p1"><span class="Apple-converted-space">      </span>const bidSummaryStatus = document.getElementById('bidSummaryStatus');</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// 檢查所有玩家是否都輸入了叫牌</p>
<p class="p1"><span class="Apple-converted-space">      </span>const allPlayersHaveBids = currentRound.bids.every(bid =&gt; bid &gt;= 0);</p>
<p class="p1"><span class="Apple-converted-space">      </span>const atLeastOneNonZeroBid = currentRound.bids.some(bid =&gt; bid &gt; 0);</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>if (allPlayersHaveBids &amp;&amp; atLeastOneNonZeroBid) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>// 搶墩/餵墩的計算是基於每人的牌數（當前回合數）</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (totalBids &gt; cardsPerPlayer) {</p>
<p class="p1"><span class="Apple-converted-space">          </span>bidSummaryStatus.textContent = `搶 ${totalBids - cardsPerPlayer} 墩`;</p>
<p class="p1"><span class="Apple-converted-space">          </span>bidSummaryStatus.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">          </span>bidSummaryStatus.classList.add('warning');</p>
<p class="p1"><span class="Apple-converted-space">        </span>} else if (totalBids &lt; cardsPerPlayer) {</p>
<p class="p1"><span class="Apple-converted-space">          </span>bidSummaryStatus.textContent = `餵 ${cardsPerPlayer - totalBids} 墩`;</p>
<p class="p1"><span class="Apple-converted-space">          </span>bidSummaryStatus.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">          </span>bidSummaryStatus.classList.add('warning');</p>
<p class="p1"><span class="Apple-converted-space">        </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">          </span>bidSummaryStatus.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">        </span>bidSummaryStatus.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>function renderScoreTable() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const currentRound = gameState.rounds[gameState.currentRoundIndex];</p>
<p class="p1"><span class="Apple-converted-space">      </span>scoreTableBody.innerHTML = '';</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// 確定第一個叫牌的玩家索引</p>
<p class="p1"><span class="Apple-converted-space">      </span>// 從當前回合數決定第一個叫牌的玩家，從玩家1開始循環</p>
<p class="p1"><span class="Apple-converted-space">      </span>const firstBidderIndex = (currentRound.roundNumber - 1) % gameState.players.length;</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>gameState.players.forEach((player, index) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>const row = document.createElement('tr');</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Player name</p>
<p class="p1"><span class="Apple-converted-space">        </span>const nameCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">        </span>nameCell.textContent = player;</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// 標記第一個叫牌的玩家</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (index === firstBidderIndex) {</p>
<p class="p1"><span class="Apple-converted-space">          </span>nameCell.classList.add('first-bidder');</p>
<p class="p1"><span class="Apple-converted-space">          </span>nameCell.title = '第一個叫牌';</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>row.appendChild(nameCell);</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Bid input</p>
<p class="p1"><span class="Apple-converted-space">        </span>const bidCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const bidInput = document.createElement('input');</p>
<p class="p1"><span class="Apple-converted-space">        </span>bidInput.type = 'number';</p>
<p class="p1"><span class="Apple-converted-space">        </span>bidInput.className = 'text-base';</p>
<p class="p1"><span class="Apple-converted-space">        </span>bidInput.min = 0;</p>
<p class="p1"><span class="Apple-converted-space">        </span>bidInput.max = currentRound.cardsPerPlayer;</p>
<p class="p1"><span class="Apple-converted-space">        </span>bidInput.value = currentRound.bids[index];</p>
<p class="p1"><span class="Apple-converted-space">        </span>bidInput.dataset.playerIndex = index;</p>
<p class="p1"><span class="Apple-converted-space">        </span>bidInput.addEventListener('change', handleBidChange);</p>
<p class="p1"><span class="Apple-converted-space">        </span>bidCell.appendChild(bidInput);</p>
<p class="p1"><span class="Apple-converted-space">        </span>row.appendChild(bidCell);</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Tricks input</p>
<p class="p1"><span class="Apple-converted-space">        </span>const trickCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const trickInput = document.createElement('input');</p>
<p class="p1"><span class="Apple-converted-space">        </span>trickInput.type = 'number';</p>
<p class="p1"><span class="Apple-converted-space">        </span>trickInput.className = 'text-base';</p>
<p class="p1"><span class="Apple-converted-space">        </span>trickInput.min = 0;</p>
<p class="p1"><span class="Apple-converted-space">        </span>trickInput.max = currentRound.cardsPerPlayer;</p>
<p class="p1"><span class="Apple-converted-space">        </span>trickInput.value = currentRound.tricks[index];</p>
<p class="p1"><span class="Apple-converted-space">        </span>trickInput.dataset.playerIndex = index;</p>
<p class="p1"><span class="Apple-converted-space">        </span>trickInput.addEventListener('change', handleTrickChange);</p>
<p class="p1"><span class="Apple-converted-space">        </span>trickCell.appendChild(trickInput);</p>
<p class="p1"><span class="Apple-converted-space">        </span>row.appendChild(trickCell);</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Round score</p>
<p class="p1"><span class="Apple-converted-space">        </span>const scoreCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">        </span>scoreCell.textContent = currentRound.scores[index];</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (currentRound.bids[index] === currentRound.tricks[index] &amp;&amp; currentRound.tricks[index] &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">          </span>scoreCell.className = 'just-made';</p>
<p class="p1"><span class="Apple-converted-space">        </span>} else if (currentRound.tricks[index] !== currentRound.bids[index] &amp;&amp; currentRound.tricks[index] &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">          </span>scoreCell.className = 'missed';</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>row.appendChild(scoreCell);</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Total score</p>
<p class="p1"><span class="Apple-converted-space">        </span>const totalCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">        </span>totalCell.textContent = currentRound.totals[index];</p>
<p class="p1"><span class="Apple-converted-space">        </span>totalCell.className = 'font-bold';</p>
<p class="p1"><span class="Apple-converted-space">        </span>row.appendChild(totalCell);</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>scoreTableBody.appendChild(row);</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Validate last player's bid</p>
<p class="p1"><span class="Apple-converted-space">      </span>validateLastPlayerBid();</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>function handleBidChange(e) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const playerIndex = parseInt(e.target.dataset.playerIndex);</p>
<p class="p1"><span class="Apple-converted-space">      </span>const bid = parseInt(e.target.value);</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Validate input</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (isNaN(bid) || bid &lt; 0 || bid &gt; gameState.rounds[gameState.currentRoundIndex].cardsPerPlayer) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>e.target.value = gameState.rounds[gameState.currentRoundIndex].bids[playerIndex];</p>
<p class="p1"><span class="Apple-converted-space">        </span>return;</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>gameState.rounds[gameState.currentRoundIndex].bids[playerIndex] = bid;</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Validate last player's bid</p>
<p class="p1"><span class="Apple-converted-space">      </span>validateLastPlayerBid();</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Update bid summary</p>
<p class="p1"><span class="Apple-converted-space">      </span>updateBidSummary();</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>function validateLastPlayerBid() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const currentRound = gameState.rounds[gameState.currentRoundIndex];</p>
<p class="p1"><span class="Apple-converted-space">      </span>const lastPlayerIndex = gameState.players.length - 1;</p>
<p class="p1"><span class="Apple-converted-space">      </span>const lastPlayerBid = currentRound.bids[lastPlayerIndex];</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>const otherBidsSum = currentRound.bids.slice(0, -1).reduce((sum, bid) =&gt; sum + bid, 0);</p>
<p class="p1"><span class="Apple-converted-space">      </span>const restrictedBid = currentRound.cardsPerPlayer - otherBidsSum;</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// If last player's bid would make total bids equal cards per player, show warning</p>
<p class="p1"><span class="Apple-converted-space">      </span>const invalid = lastPlayerBid === restrictedBid;</p>
<p class="p1"><span class="Apple-converted-space">      </span>lastPlayerWarningSpan.classList.toggle('hidden', !invalid);</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// If invalid, highlight the input</p>
<p class="p1"><span class="Apple-converted-space">      </span>const lastPlayerInput = document.querySelector(`input[data-player-index="${lastPlayerIndex}"]`);</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (lastPlayerInput) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>lastPlayerInput.classList.toggle('border-red-500', invalid);</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>function handleTrickChange(e) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const playerIndex = parseInt(e.target.dataset.playerIndex);</p>
<p class="p1"><span class="Apple-converted-space">      </span>const tricks = parseInt(e.target.value);</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Validate input</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (isNaN(tricks) || tricks &lt; 0 || tricks &gt; gameState.rounds[gameState.currentRoundIndex].cardsPerPlayer) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>e.target.value = gameState.rounds[gameState.currentRoundIndex].tricks[playerIndex];</p>
<p class="p1"><span class="Apple-converted-space">        </span>return;</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>gameState.rounds[gameState.currentRoundIndex].tricks[playerIndex] = tricks;</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Calculate scores</p>
<p class="p1"><span class="Apple-converted-space">      </span>calculateScores();</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Update the score table</p>
<p class="p1"><span class="Apple-converted-space">      </span>renderScoreTable();</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>function calculateScores() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const currentRound = gameState.rounds[gameState.currentRoundIndex];</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Calculate scores for each player</p>
<p class="p1"><span class="Apple-converted-space">      </span>gameState.players.forEach((player, index) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>const bid = currentRound.bids[index];</p>
<p class="p1"><span class="Apple-converted-space">        </span>const tricks = currentRound.tricks[index];</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>let score;</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (bid === tricks) {</p>
<p class="p1"><span class="Apple-converted-space">          </span>// Just made - 10 + bid^2</p>
<p class="p1"><span class="Apple-converted-space">          </span>score = 10 + bid * bid;</p>
<p class="p1"><span class="Apple-converted-space">        </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">          </span>// Missed - -(tricks - bid)^2</p>
<p class="p1"><span class="Apple-converted-space">          </span>score = -Math.pow(tricks - bid, 2);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>currentRound.scores[index] = score;</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Update totals</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (gameState.currentRoundIndex &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">          </span>const previousRound = gameState.rounds[gameState.currentRoundIndex - 1];</p>
<p class="p1"><span class="Apple-converted-space">          </span>currentRound.totals[index] = previousRound.totals[index] + score;</p>
<p class="p1"><span class="Apple-converted-space">        </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">          </span>currentRound.totals[index] = score;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Update subsequent rounds' totals</p>
<p class="p1"><span class="Apple-converted-space">      </span>for (let i = gameState.currentRoundIndex + 1; i &lt; gameState.rounds.length; i++) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>const prevRound = gameState.rounds[i - 1];</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>for (let p = 0; p &lt; gameState.players.length; p++) {</p>
<p class="p1"><span class="Apple-converted-space">          </span>gameState.rounds[i].totals[p] = prevRound.totals[p] + gameState.rounds[i].scores[p];</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>// History view</p>
<p class="p1"><span class="Apple-converted-space">    </span>function renderHistoryTable() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>// Build header</p>
<p class="p1"><span class="Apple-converted-space">      </span>const headerRow = historyTableHead.querySelector('tr');</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Clear existing player columns</p>
<p class="p1"><span class="Apple-converted-space">      </span>while (headerRow.children.length &gt; 2) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>headerRow.removeChild(headerRow.lastChild);</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Add player columns</p>
<p class="p1"><span class="Apple-converted-space">      </span>gameState.players.forEach(player =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>const th = document.createElement('th');</p>
<p class="p1"><span class="Apple-converted-space">        </span>th.textContent = player;</p>
<p class="p1"><span class="Apple-converted-space">        </span>headerRow.appendChild(th);</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Build table body</p>
<p class="p1"><span class="Apple-converted-space">      </span>historyTableBody.innerHTML = '';</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>gameState.rounds.forEach(round =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>// Create a header row for the round</p>
<p class="p1"><span class="Apple-converted-space">        </span>const roundHeaderRow = document.createElement('tr');</p>
<p class="p1"><span class="Apple-converted-space">        </span>roundHeaderRow.className = 'bg-gray-100 dark:bg-gray-700';</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>const roundCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">        </span>roundCell.textContent = `回合 ${round.roundNumber}`;</p>
<p class="p1"><span class="Apple-converted-space">        </span>roundCell.colSpan = 2;</p>
<p class="p1"><span class="Apple-converted-space">        </span>roundCell.className = 'font-bold';</p>
<p class="p1"><span class="Apple-converted-space">        </span>roundHeaderRow.appendChild(roundCell);</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>gameState.players.forEach(player =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">          </span>const emptyCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">          </span>roundHeaderRow.appendChild(emptyCell);</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>historyTableBody.appendChild(roundHeaderRow);</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Create bid row</p>
<p class="p1"><span class="Apple-converted-space">        </span>const bidRow = document.createElement('tr');</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>const bidLabelCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">        </span>bidLabelCell.textContent = '叫牌';</p>
<p class="p1"><span class="Apple-converted-space">        </span>bidLabelCell.className = 'pl-6';</p>
<p class="p1"><span class="Apple-converted-space">        </span>bidRow.appendChild(bidLabelCell);</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Trump cell</p>
<p class="p1"><span class="Apple-converted-space">        </span>const trumpCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (round.trump) {</p>
<p class="p1"><span class="Apple-converted-space">          </span>let trumpSymbol = '';</p>
<p class="p1"><span class="Apple-converted-space">          </span>switch (round.trump) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>case 'spades': trumpSymbol = '♠'; break;</p>
<p class="p1"><span class="Apple-converted-space">            </span>case 'hearts': trumpSymbol = '♥'; break;</p>
<p class="p1"><span class="Apple-converted-space">            </span>case 'diamonds': trumpSymbol = '♦'; break;</p>
<p class="p1"><span class="Apple-converted-space">            </span>case 'clubs': trumpSymbol = '♣'; break;</p>
<p class="p1"><span class="Apple-converted-space">          </span>}</p>
<p class="p1"><span class="Apple-converted-space">          </span>trumpCell.innerHTML = `&lt;span class="suit ${round.trump}"&gt;${trumpSymbol}&lt;/span&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">        </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">          </span>trumpCell.textContent = '-';</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>bidRow.appendChild(trumpCell);</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Player bids</p>
<p class="p1"><span class="Apple-converted-space">        </span>round.bids.forEach(bid =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">          </span>const bidCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">          </span>bidCell.textContent = bid;</p>
<p class="p1"><span class="Apple-converted-space">          </span>bidRow.appendChild(bidCell);</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>historyTableBody.appendChild(bidRow);</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Create tricks row</p>
<p class="p1"><span class="Apple-converted-space">        </span>const trickRow = document.createElement('tr');</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>const trickLabelCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">        </span>trickLabelCell.textContent = '贏墩';</p>
<p class="p1"><span class="Apple-converted-space">        </span>trickLabelCell.className = 'pl-6';</p>
<p class="p1"><span class="Apple-converted-space">        </span>trickRow.appendChild(trickLabelCell);</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>const emptyTrumpCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">        </span>trickRow.appendChild(emptyTrumpCell);</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Player tricks</p>
<p class="p1"><span class="Apple-converted-space">        </span>round.tricks.forEach(trick =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">          </span>const trickCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">          </span>trickCell.textContent = trick;</p>
<p class="p1"><span class="Apple-converted-space">          </span>trickRow.appendChild(trickCell);</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>historyTableBody.appendChild(trickRow);</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Create score row</p>
<p class="p1"><span class="Apple-converted-space">        </span>const scoreRow = document.createElement('tr');</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>const scoreLabelCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">        </span>scoreLabelCell.textContent = '得分';</p>
<p class="p1"><span class="Apple-converted-space">        </span>scoreLabelCell.className = 'pl-6';</p>
<p class="p1"><span class="Apple-converted-space">        </span>scoreRow.appendChild(scoreLabelCell);</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>const emptyScoreTrumpCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">        </span>scoreRow.appendChild(emptyScoreTrumpCell);</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Player scores</p>
<p class="p1"><span class="Apple-converted-space">        </span>round.scores.forEach((score, index) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">          </span>const scoreCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">          </span>scoreCell.textContent = score;</p>
<p class="p2"><span class="Apple-converted-space">          </span></p>
<p class="p1"><span class="Apple-converted-space">          </span>if (round.bids[index] === round.tricks[index] &amp;&amp; round.tricks[index] &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>scoreCell.className = 'just-made';</p>
<p class="p1"><span class="Apple-converted-space">          </span>} else if (round.tricks[index] !== round.bids[index] &amp;&amp; round.tricks[index] &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>scoreCell.className = 'missed';</p>
<p class="p1"><span class="Apple-converted-space">          </span>}</p>
<p class="p2"><span class="Apple-converted-space">          </span></p>
<p class="p1"><span class="Apple-converted-space">          </span>scoreRow.appendChild(scoreCell);</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>historyTableBody.appendChild(scoreRow);</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Create total row</p>
<p class="p1"><span class="Apple-converted-space">        </span>const totalRow = document.createElement('tr');</p>
<p class="p1"><span class="Apple-converted-space">        </span>totalRow.className = 'border-b-2 border-gray-500';</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>const totalLabelCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">        </span>totalLabelCell.textContent = '總分';</p>
<p class="p1"><span class="Apple-converted-space">        </span>totalLabelCell.className = 'pl-6 font-bold';</p>
<p class="p1"><span class="Apple-converted-space">        </span>totalRow.appendChild(totalLabelCell);</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>const emptyTotalTrumpCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">        </span>totalRow.appendChild(emptyTotalTrumpCell);</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Player totals</p>
<p class="p1"><span class="Apple-converted-space">        </span>round.totals.forEach(total =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">          </span>const totalCell = document.createElement('td');</p>
<p class="p1"><span class="Apple-converted-space">          </span>totalCell.textContent = total;</p>
<p class="p1"><span class="Apple-converted-space">          </span>totalCell.className = 'font-bold';</p>
<p class="p1"><span class="Apple-converted-space">          </span>totalRow.appendChild(totalCell);</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>historyTableBody.appendChild(totalRow);</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>// 自定義確認對話框</p>
<p class="p1"><span class="Apple-converted-space">    </span>const confirmModal = document.getElementById('confirmModal');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const confirmMessage = document.getElementById('confirmMessage');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const confirmBtn = document.getElementById('confirmBtn');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const cancelBtn = document.getElementById('cancelBtn');</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>function showConfirmModal(message, confirmCallback) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>confirmMessage.textContent = message;</p>
<p class="p1"><span class="Apple-converted-space">      </span>confirmModal.classList.remove('hidden');</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>// 設置確認和取消按鈕的行為</p>
<p class="p1"><span class="Apple-converted-space">      </span>const handleConfirm = () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>confirmModal.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">        </span>confirmBtn.removeEventListener('click', handleConfirm);</p>
<p class="p1"><span class="Apple-converted-space">        </span>cancelBtn.removeEventListener('click', handleCancel);</p>
<p class="p1"><span class="Apple-converted-space">        </span>confirmCallback();</p>
<p class="p1"><span class="Apple-converted-space">      </span>};</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>const handleCancel = () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>confirmModal.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">        </span>confirmBtn.removeEventListener('click', handleConfirm);</p>
<p class="p1"><span class="Apple-converted-space">        </span>cancelBtn.removeEventListener('click', handleCancel);</p>
<p class="p1"><span class="Apple-converted-space">      </span>};</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>confirmBtn.addEventListener('click', handleConfirm);</p>
<p class="p1"><span class="Apple-converted-space">      </span>cancelBtn.addEventListener('click', handleCancel);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Reset game</p>
<p class="p1"><span class="Apple-converted-space">    </span>function confirmResetGame() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>showConfirmModal('確定要重置遊戲嗎？所有數據將被清除！', resetGame);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>function resetGame() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>showScreen(setupScreen);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Initialize the app</p>
<p class="p1"><span class="Apple-converted-space">    </span>init();</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
